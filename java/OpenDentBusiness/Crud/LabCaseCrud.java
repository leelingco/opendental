//
// Translated by CS2J (http://www.cs2j.com): 2/15/2016 5:58:05 PM
//

package OpenDentBusiness.Crud;

import CS2JNet.System.StringSupport;
import OpenDentBusiness.Db;
import OpenDentBusiness.DbHelper;
import OpenDentBusiness.LabCase;
import OpenDentBusiness.PIn;
import OpenDentBusiness.POut;
import OpenDentBusiness.PrefC;
import OpenDentBusiness.RemotingClient;
import OpenDentBusiness.RemotingRole;
import OpenDentBusiness.ReplicationServers;

//This file is automatically generated.
//Do not attempt to make changes to this file because the changes will be erased and overwritten.
public class LabCaseCrud   
{
    /**
    * Gets one LabCase object from the database using the primary key.  Returns null if not found.
    */
    public static LabCase selectOne(long labCaseNum) throws Exception {
        String command = "SELECT * FROM labcase " + "WHERE LabCaseNum = " + POut.long(labCaseNum);
        List<LabCase> list = tableToList(Db.getTable(command));
        if (list.Count == 0)
        {
            return null;
        }
         
        return list[0];
    }

    /**
    * Gets one LabCase object from the database using a query.
    */
    public static LabCase selectOne(String command) throws Exception {
        if (RemotingClient.RemotingRole == RemotingRole.ClientWeb)
        {
            throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n" + command);
        }
         
        List<LabCase> list = tableToList(Db.getTable(command));
        if (list.Count == 0)
        {
            return null;
        }
         
        return list[0];
    }

    /**
    * Gets a list of LabCase objects from the database using a query.
    */
    public static List<LabCase> selectMany(String command) throws Exception {
        if (RemotingClient.RemotingRole == RemotingRole.ClientWeb)
        {
            throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n" + command);
        }
         
        List<LabCase> list = tableToList(Db.getTable(command));
        return list;
    }

    /**
    * Converts a DataTable to a list of objects.
    */
    public static List<LabCase> tableToList(DataTable table) throws Exception {
        List<LabCase> retVal = new List<LabCase>();
        LabCase labCase;
        for (int i = 0;i < table.Rows.Count;i++)
        {
            labCase = new LabCase();
            labCase.LabCaseNum = PIn.Long(table.Rows[i]["LabCaseNum"].ToString());
            labCase.PatNum = PIn.Long(table.Rows[i]["PatNum"].ToString());
            labCase.LaboratoryNum = PIn.Long(table.Rows[i]["LaboratoryNum"].ToString());
            labCase.AptNum = PIn.Long(table.Rows[i]["AptNum"].ToString());
            labCase.PlannedAptNum = PIn.Long(table.Rows[i]["PlannedAptNum"].ToString());
            labCase.DateTimeDue = PIn.DateT(table.Rows[i]["DateTimeDue"].ToString());
            labCase.DateTimeCreated = PIn.DateT(table.Rows[i]["DateTimeCreated"].ToString());
            labCase.DateTimeSent = PIn.DateT(table.Rows[i]["DateTimeSent"].ToString());
            labCase.DateTimeRecd = PIn.DateT(table.Rows[i]["DateTimeRecd"].ToString());
            labCase.DateTimeChecked = PIn.DateT(table.Rows[i]["DateTimeChecked"].ToString());
            labCase.ProvNum = PIn.Long(table.Rows[i]["ProvNum"].ToString());
            labCase.Instructions = PIn.String(table.Rows[i]["Instructions"].ToString());
            labCase.LabFee = PIn.Double(table.Rows[i]["LabFee"].ToString());
            retVal.Add(labCase);
        }
        return retVal;
    }

    /**
    * Inserts one LabCase into the database.  Returns the new priKey.
    */
    public static long insert(LabCase labCase) throws Exception {
        if (OpenDentBusiness.DataConnection.DBtype == OpenDentBusiness.DatabaseType.Oracle)
        {
            labCase.LabCaseNum = DbHelper.getNextOracleKey("labcase","LabCaseNum");
            int loopcount = 0;
            while (loopcount < 100)
            {
                try
                {
                    return Insert(labCase, true);
                }
                catch (Oracle.DataAccess.Client.OracleException ex)
                {
                    if (ex.Number == 1 && ex.Message.ToLower().Contains("unique constraint") && ex.Message.ToLower().Contains("violated"))
                    {
                        labCase.LabCaseNum++;
                        loopcount++;
                    }
                    else
                    {
                        throw ex;
                    } 
                }
            
            }
            throw new ApplicationException("Insert failed.  Could not generate primary key.");
        }
        else
        {
            return Insert(labCase, false);
        } 
    }

    /**
    * Inserts one LabCase into the database.  Provides option to use the existing priKey.
    */
    public static long insert(LabCase labCase, boolean useExistingPK) throws Exception {
        if (!useExistingPK && PrefC.getRandomKeys())
        {
            labCase.LabCaseNum = ReplicationServers.getKey("labcase","LabCaseNum");
        }
         
        String command = "INSERT INTO labcase (";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            command += "LabCaseNum,";
        }
         
        command += "PatNum,LaboratoryNum,AptNum,PlannedAptNum,DateTimeDue,DateTimeCreated,DateTimeSent,DateTimeRecd,DateTimeChecked,ProvNum,Instructions,LabFee) VALUES(";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            command += POut.long(labCase.LabCaseNum) + ",";
        }
         
        command += POut.long(labCase.PatNum) + "," + POut.long(labCase.LaboratoryNum) + "," + POut.long(labCase.AptNum) + "," + POut.long(labCase.PlannedAptNum) + "," + POut.dateT(labCase.DateTimeDue) + "," + POut.dateT(labCase.DateTimeCreated) + "," + POut.dateT(labCase.DateTimeSent) + "," + POut.dateT(labCase.DateTimeRecd) + "," + POut.dateT(labCase.DateTimeChecked) + "," + POut.long(labCase.ProvNum) + "," + "'" + POut.string(labCase.Instructions) + "'," + "'" + POut.double(labCase.LabFee) + "')";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            Db.nonQ(command);
        }
        else
        {
            labCase.LabCaseNum = Db.nonQ(command,true);
        } 
        return labCase.LabCaseNum;
    }

    /**
    * Updates one LabCase in the database.
    */
    public static void update(LabCase labCase) throws Exception {
        String command = "UPDATE labcase SET " + "PatNum         =  " + POut.long(labCase.PatNum) + ", " + "LaboratoryNum  =  " + POut.long(labCase.LaboratoryNum) + ", " + "AptNum         =  " + POut.long(labCase.AptNum) + ", " + "PlannedAptNum  =  " + POut.long(labCase.PlannedAptNum) + ", " + "DateTimeDue    =  " + POut.dateT(labCase.DateTimeDue) + ", " + "DateTimeCreated=  " + POut.dateT(labCase.DateTimeCreated) + ", " + "DateTimeSent   =  " + POut.dateT(labCase.DateTimeSent) + ", " + "DateTimeRecd   =  " + POut.dateT(labCase.DateTimeRecd) + ", " + "DateTimeChecked=  " + POut.dateT(labCase.DateTimeChecked) + ", " + "ProvNum        =  " + POut.long(labCase.ProvNum) + ", " + "Instructions   = '" + POut.string(labCase.Instructions) + "', " + "LabFee         = '" + POut.double(labCase.LabFee) + "' " + "WHERE LabCaseNum = " + POut.long(labCase.LabCaseNum);
        Db.nonQ(command);
    }

    /**
    * Updates one LabCase in the database.  Uses an old object to compare to, and only alters changed fields.  This prevents collisions and concurrency problems in heavily used tables.
    */
    public static void update(LabCase labCase, LabCase oldLabCase) throws Exception {
        String command = "";
        if (labCase.PatNum != oldLabCase.PatNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "PatNum = " + POut.long(labCase.PatNum) + "";
        }
         
        if (labCase.LaboratoryNum != oldLabCase.LaboratoryNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "LaboratoryNum = " + POut.long(labCase.LaboratoryNum) + "";
        }
         
        if (labCase.AptNum != oldLabCase.AptNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "AptNum = " + POut.long(labCase.AptNum) + "";
        }
         
        if (labCase.PlannedAptNum != oldLabCase.PlannedAptNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "PlannedAptNum = " + POut.long(labCase.PlannedAptNum) + "";
        }
         
        if (labCase.DateTimeDue != oldLabCase.DateTimeDue)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DateTimeDue = " + POut.dateT(labCase.DateTimeDue) + "";
        }
         
        if (labCase.DateTimeCreated != oldLabCase.DateTimeCreated)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DateTimeCreated = " + POut.dateT(labCase.DateTimeCreated) + "";
        }
         
        if (labCase.DateTimeSent != oldLabCase.DateTimeSent)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DateTimeSent = " + POut.dateT(labCase.DateTimeSent) + "";
        }
         
        if (labCase.DateTimeRecd != oldLabCase.DateTimeRecd)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DateTimeRecd = " + POut.dateT(labCase.DateTimeRecd) + "";
        }
         
        if (labCase.DateTimeChecked != oldLabCase.DateTimeChecked)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DateTimeChecked = " + POut.dateT(labCase.DateTimeChecked) + "";
        }
         
        if (labCase.ProvNum != oldLabCase.ProvNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "ProvNum = " + POut.long(labCase.ProvNum) + "";
        }
         
        if (!StringSupport.equals(labCase.Instructions, oldLabCase.Instructions))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "Instructions = '" + POut.string(labCase.Instructions) + "'";
        }
         
        if (labCase.LabFee != oldLabCase.LabFee)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "LabFee = '" + POut.double(labCase.LabFee) + "'";
        }
         
        if (StringSupport.equals(command, ""))
        {
            return ;
        }
         
        command = "UPDATE labcase SET " + command + " WHERE LabCaseNum = " + POut.long(labCase.LabCaseNum);
        Db.nonQ(command);
    }

    /**
    * Deletes one LabCase from the database.
    */
    public static void delete(long labCaseNum) throws Exception {
        String command = "DELETE FROM labcase " + "WHERE LabCaseNum = " + POut.long(labCaseNum);
        Db.nonQ(command);
    }

}


