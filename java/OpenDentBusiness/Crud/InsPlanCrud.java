//
// Translated by CS2J (http://www.cs2j.com): 2/15/2016 5:58:04 PM
//

package OpenDentBusiness.Crud;

import CS2JNet.System.StringSupport;
import OpenDentBusiness.Db;
import OpenDentBusiness.DbHelper;
import OpenDentBusiness.EnumCobRule;
import OpenDentBusiness.InsPlan;
import OpenDentBusiness.PIn;
import OpenDentBusiness.POut;
import OpenDentBusiness.PrefC;
import OpenDentBusiness.RemotingClient;
import OpenDentBusiness.RemotingRole;
import OpenDentBusiness.ReplicationServers;

//This file is automatically generated.
//Do not attempt to make changes to this file because the changes will be erased and overwritten.
public class InsPlanCrud   
{
    /**
    * Gets one InsPlan object from the database using the primary key.  Returns null if not found.
    */
    public static InsPlan selectOne(long planNum) throws Exception {
        String command = "SELECT * FROM insplan " + "WHERE PlanNum = " + POut.long(planNum);
        List<InsPlan> list = tableToList(Db.getTable(command));
        if (list.Count == 0)
        {
            return null;
        }
         
        return list[0];
    }

    /**
    * Gets one InsPlan object from the database using a query.
    */
    public static InsPlan selectOne(String command) throws Exception {
        if (RemotingClient.RemotingRole == RemotingRole.ClientWeb)
        {
            throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n" + command);
        }
         
        List<InsPlan> list = tableToList(Db.getTable(command));
        if (list.Count == 0)
        {
            return null;
        }
         
        return list[0];
    }

    /**
    * Gets a list of InsPlan objects from the database using a query.
    */
    public static List<InsPlan> selectMany(String command) throws Exception {
        if (RemotingClient.RemotingRole == RemotingRole.ClientWeb)
        {
            throw new ApplicationException("Not allowed to send sql directly.  Rewrite the calling class to not use this query:\r\n" + command);
        }
         
        List<InsPlan> list = tableToList(Db.getTable(command));
        return list;
    }

    /**
    * Converts a DataTable to a list of objects.
    */
    public static List<InsPlan> tableToList(DataTable table) throws Exception {
        List<InsPlan> retVal = new List<InsPlan>();
        InsPlan insPlan;
        for (int i = 0;i < table.Rows.Count;i++)
        {
            insPlan = new InsPlan();
            insPlan.PlanNum = PIn.Long(table.Rows[i]["PlanNum"].ToString());
            insPlan.GroupName = PIn.String(table.Rows[i]["GroupName"].ToString());
            insPlan.GroupNum = PIn.String(table.Rows[i]["GroupNum"].ToString());
            insPlan.PlanNote = PIn.String(table.Rows[i]["PlanNote"].ToString());
            insPlan.FeeSched = PIn.Long(table.Rows[i]["FeeSched"].ToString());
            insPlan.PlanType = PIn.String(table.Rows[i]["PlanType"].ToString());
            insPlan.ClaimFormNum = PIn.Long(table.Rows[i]["ClaimFormNum"].ToString());
            insPlan.UseAltCode = PIn.Bool(table.Rows[i]["UseAltCode"].ToString());
            insPlan.ClaimsUseUCR = PIn.Bool(table.Rows[i]["ClaimsUseUCR"].ToString());
            insPlan.CopayFeeSched = PIn.Long(table.Rows[i]["CopayFeeSched"].ToString());
            insPlan.EmployerNum = PIn.Long(table.Rows[i]["EmployerNum"].ToString());
            insPlan.CarrierNum = PIn.Long(table.Rows[i]["CarrierNum"].ToString());
            insPlan.AllowedFeeSched = PIn.Long(table.Rows[i]["AllowedFeeSched"].ToString());
            insPlan.TrojanID = PIn.String(table.Rows[i]["TrojanID"].ToString());
            insPlan.DivisionNo = PIn.String(table.Rows[i]["DivisionNo"].ToString());
            insPlan.IsMedical = PIn.Bool(table.Rows[i]["IsMedical"].ToString());
            insPlan.FilingCode = PIn.Long(table.Rows[i]["FilingCode"].ToString());
            insPlan.DentaideCardSequence = PIn.Byte(table.Rows[i]["DentaideCardSequence"].ToString());
            insPlan.ShowBaseUnits = PIn.Bool(table.Rows[i]["ShowBaseUnits"].ToString());
            insPlan.CodeSubstNone = PIn.Bool(table.Rows[i]["CodeSubstNone"].ToString());
            insPlan.IsHidden = PIn.Bool(table.Rows[i]["IsHidden"].ToString());
            insPlan.MonthRenew = PIn.Byte(table.Rows[i]["MonthRenew"].ToString());
            insPlan.FilingCodeSubtype = PIn.Long(table.Rows[i]["FilingCodeSubtype"].ToString());
            insPlan.CanadianPlanFlag = PIn.String(table.Rows[i]["CanadianPlanFlag"].ToString());
            insPlan.CanadianDiagnosticCode = PIn.String(table.Rows[i]["CanadianDiagnosticCode"].ToString());
            insPlan.CanadianInstitutionCode = PIn.String(table.Rows[i]["CanadianInstitutionCode"].ToString());
            insPlan.RxBIN = PIn.String(table.Rows[i]["RxBIN"].ToString());
            insPlan.CobRule = (EnumCobRule)PIn.Int(table.Rows[i]["CobRule"].ToString());
            insPlan.SopCode = PIn.String(table.Rows[i]["SopCode"].ToString());
            retVal.Add(insPlan);
        }
        return retVal;
    }

    /**
    * Inserts one InsPlan into the database.  Returns the new priKey.
    */
    public static long insert(InsPlan insPlan) throws Exception {
        if (OpenDentBusiness.DataConnection.DBtype == OpenDentBusiness.DatabaseType.Oracle)
        {
            insPlan.PlanNum = DbHelper.getNextOracleKey("insplan","PlanNum");
            int loopcount = 0;
            while (loopcount < 100)
            {
                try
                {
                    return Insert(insPlan, true);
                }
                catch (Oracle.DataAccess.Client.OracleException ex)
                {
                    if (ex.Number == 1 && ex.Message.ToLower().Contains("unique constraint") && ex.Message.ToLower().Contains("violated"))
                    {
                        insPlan.PlanNum++;
                        loopcount++;
                    }
                    else
                    {
                        throw ex;
                    } 
                }
            
            }
            throw new ApplicationException("Insert failed.  Could not generate primary key.");
        }
        else
        {
            return Insert(insPlan, false);
        } 
    }

    /**
    * Inserts one InsPlan into the database.  Provides option to use the existing priKey.
    */
    public static long insert(InsPlan insPlan, boolean useExistingPK) throws Exception {
        if (!useExistingPK && PrefC.getRandomKeys())
        {
            insPlan.PlanNum = ReplicationServers.getKey("insplan","PlanNum");
        }
         
        String command = "INSERT INTO insplan (";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            command += "PlanNum,";
        }
         
        command += "GroupName,GroupNum,PlanNote,FeeSched,PlanType,ClaimFormNum,UseAltCode,ClaimsUseUCR,CopayFeeSched,EmployerNum,CarrierNum,AllowedFeeSched,TrojanID,DivisionNo,IsMedical,FilingCode,DentaideCardSequence,ShowBaseUnits,CodeSubstNone,IsHidden,MonthRenew,FilingCodeSubtype,CanadianPlanFlag,CanadianDiagnosticCode,CanadianInstitutionCode,RxBIN,CobRule,SopCode) VALUES(";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            command += POut.long(insPlan.PlanNum) + ",";
        }
         
        command += "'" + POut.string(insPlan.GroupName) + "'," + "'" + POut.string(insPlan.GroupNum) + "'," + "'" + POut.string(insPlan.PlanNote) + "'," + POut.long(insPlan.FeeSched) + "," + "'" + POut.string(insPlan.PlanType) + "'," + POut.long(insPlan.ClaimFormNum) + "," + POut.bool(insPlan.UseAltCode) + "," + POut.bool(insPlan.ClaimsUseUCR) + "," + POut.long(insPlan.CopayFeeSched) + "," + POut.long(insPlan.EmployerNum) + "," + POut.long(insPlan.CarrierNum) + "," + POut.long(insPlan.AllowedFeeSched) + "," + "'" + POut.string(insPlan.TrojanID) + "'," + "'" + POut.string(insPlan.DivisionNo) + "'," + POut.bool(insPlan.IsMedical) + "," + POut.long(insPlan.FilingCode) + "," + POut.byte(insPlan.DentaideCardSequence) + "," + POut.bool(insPlan.ShowBaseUnits) + "," + POut.bool(insPlan.CodeSubstNone) + "," + POut.bool(insPlan.IsHidden) + "," + POut.byte(insPlan.MonthRenew) + "," + POut.long(insPlan.FilingCodeSubtype) + "," + "'" + POut.string(insPlan.CanadianPlanFlag) + "'," + "'" + POut.string(insPlan.CanadianDiagnosticCode) + "'," + "'" + POut.string(insPlan.CanadianInstitutionCode) + "'," + "'" + POut.string(insPlan.RxBIN) + "'," + POut.int(((Enum)insPlan.CobRule).ordinal()) + "," + "'" + POut.string(insPlan.SopCode) + "')";
        if (useExistingPK || PrefC.getRandomKeys())
        {
            Db.nonQ(command);
        }
        else
        {
            insPlan.PlanNum = Db.nonQ(command,true);
        } 
        return insPlan.PlanNum;
    }

    /**
    * Updates one InsPlan in the database.
    */
    public static void update(InsPlan insPlan) throws Exception {
        String command = "UPDATE insplan SET " + "GroupName              = '" + POut.string(insPlan.GroupName) + "', " + "GroupNum               = '" + POut.string(insPlan.GroupNum) + "', " + "PlanNote               = '" + POut.string(insPlan.PlanNote) + "', " + "FeeSched               =  " + POut.long(insPlan.FeeSched) + ", " + "PlanType               = '" + POut.string(insPlan.PlanType) + "', " + "ClaimFormNum           =  " + POut.long(insPlan.ClaimFormNum) + ", " + "UseAltCode             =  " + POut.bool(insPlan.UseAltCode) + ", " + "ClaimsUseUCR           =  " + POut.bool(insPlan.ClaimsUseUCR) + ", " + "CopayFeeSched          =  " + POut.long(insPlan.CopayFeeSched) + ", " + "EmployerNum            =  " + POut.long(insPlan.EmployerNum) + ", " + "CarrierNum             =  " + POut.long(insPlan.CarrierNum) + ", " + "AllowedFeeSched        =  " + POut.long(insPlan.AllowedFeeSched) + ", " + "TrojanID               = '" + POut.string(insPlan.TrojanID) + "', " + "DivisionNo             = '" + POut.string(insPlan.DivisionNo) + "', " + "IsMedical              =  " + POut.bool(insPlan.IsMedical) + ", " + "FilingCode             =  " + POut.long(insPlan.FilingCode) + ", " + "DentaideCardSequence   =  " + POut.byte(insPlan.DentaideCardSequence) + ", " + "ShowBaseUnits          =  " + POut.bool(insPlan.ShowBaseUnits) + ", " + "CodeSubstNone          =  " + POut.bool(insPlan.CodeSubstNone) + ", " + "IsHidden               =  " + POut.bool(insPlan.IsHidden) + ", " + "MonthRenew             =  " + POut.byte(insPlan.MonthRenew) + ", " + "FilingCodeSubtype      =  " + POut.long(insPlan.FilingCodeSubtype) + ", " + "CanadianPlanFlag       = '" + POut.string(insPlan.CanadianPlanFlag) + "', " + "CanadianDiagnosticCode = '" + POut.string(insPlan.CanadianDiagnosticCode) + "', " + "CanadianInstitutionCode= '" + POut.string(insPlan.CanadianInstitutionCode) + "', " + "RxBIN                  = '" + POut.string(insPlan.RxBIN) + "', " + "CobRule                =  " + POut.int(((Enum)insPlan.CobRule).ordinal()) + ", " + "SopCode                = '" + POut.string(insPlan.SopCode) + "' " + "WHERE PlanNum = " + POut.long(insPlan.PlanNum);
        Db.nonQ(command);
    }

    /**
    * Updates one InsPlan in the database.  Uses an old object to compare to, and only alters changed fields.  This prevents collisions and concurrency problems in heavily used tables.
    */
    public static void update(InsPlan insPlan, InsPlan oldInsPlan) throws Exception {
        String command = "";
        if (!StringSupport.equals(insPlan.GroupName, oldInsPlan.GroupName))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "GroupName = '" + POut.string(insPlan.GroupName) + "'";
        }
         
        if (!StringSupport.equals(insPlan.GroupNum, oldInsPlan.GroupNum))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "GroupNum = '" + POut.string(insPlan.GroupNum) + "'";
        }
         
        if (!StringSupport.equals(insPlan.PlanNote, oldInsPlan.PlanNote))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "PlanNote = '" + POut.string(insPlan.PlanNote) + "'";
        }
         
        if (insPlan.FeeSched != oldInsPlan.FeeSched)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "FeeSched = " + POut.long(insPlan.FeeSched) + "";
        }
         
        if (!StringSupport.equals(insPlan.PlanType, oldInsPlan.PlanType))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "PlanType = '" + POut.string(insPlan.PlanType) + "'";
        }
         
        if (insPlan.ClaimFormNum != oldInsPlan.ClaimFormNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "ClaimFormNum = " + POut.long(insPlan.ClaimFormNum) + "";
        }
         
        if (insPlan.UseAltCode != oldInsPlan.UseAltCode)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "UseAltCode = " + POut.bool(insPlan.UseAltCode) + "";
        }
         
        if (insPlan.ClaimsUseUCR != oldInsPlan.ClaimsUseUCR)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "ClaimsUseUCR = " + POut.bool(insPlan.ClaimsUseUCR) + "";
        }
         
        if (insPlan.CopayFeeSched != oldInsPlan.CopayFeeSched)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CopayFeeSched = " + POut.long(insPlan.CopayFeeSched) + "";
        }
         
        if (insPlan.EmployerNum != oldInsPlan.EmployerNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "EmployerNum = " + POut.long(insPlan.EmployerNum) + "";
        }
         
        if (insPlan.CarrierNum != oldInsPlan.CarrierNum)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CarrierNum = " + POut.long(insPlan.CarrierNum) + "";
        }
         
        if (insPlan.AllowedFeeSched != oldInsPlan.AllowedFeeSched)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "AllowedFeeSched = " + POut.long(insPlan.AllowedFeeSched) + "";
        }
         
        if (!StringSupport.equals(insPlan.TrojanID, oldInsPlan.TrojanID))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "TrojanID = '" + POut.string(insPlan.TrojanID) + "'";
        }
         
        if (!StringSupport.equals(insPlan.DivisionNo, oldInsPlan.DivisionNo))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DivisionNo = '" + POut.string(insPlan.DivisionNo) + "'";
        }
         
        if (insPlan.IsMedical != oldInsPlan.IsMedical)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "IsMedical = " + POut.bool(insPlan.IsMedical) + "";
        }
         
        if (insPlan.FilingCode != oldInsPlan.FilingCode)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "FilingCode = " + POut.long(insPlan.FilingCode) + "";
        }
         
        if (insPlan.DentaideCardSequence != oldInsPlan.DentaideCardSequence)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "DentaideCardSequence = " + POut.byte(insPlan.DentaideCardSequence) + "";
        }
         
        if (insPlan.ShowBaseUnits != oldInsPlan.ShowBaseUnits)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "ShowBaseUnits = " + POut.bool(insPlan.ShowBaseUnits) + "";
        }
         
        if (insPlan.CodeSubstNone != oldInsPlan.CodeSubstNone)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CodeSubstNone = " + POut.bool(insPlan.CodeSubstNone) + "";
        }
         
        if (insPlan.IsHidden != oldInsPlan.IsHidden)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "IsHidden = " + POut.bool(insPlan.IsHidden) + "";
        }
         
        if (insPlan.MonthRenew != oldInsPlan.MonthRenew)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "MonthRenew = " + POut.byte(insPlan.MonthRenew) + "";
        }
         
        if (insPlan.FilingCodeSubtype != oldInsPlan.FilingCodeSubtype)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "FilingCodeSubtype = " + POut.long(insPlan.FilingCodeSubtype) + "";
        }
         
        if (!StringSupport.equals(insPlan.CanadianPlanFlag, oldInsPlan.CanadianPlanFlag))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CanadianPlanFlag = '" + POut.string(insPlan.CanadianPlanFlag) + "'";
        }
         
        if (!StringSupport.equals(insPlan.CanadianDiagnosticCode, oldInsPlan.CanadianDiagnosticCode))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CanadianDiagnosticCode = '" + POut.string(insPlan.CanadianDiagnosticCode) + "'";
        }
         
        if (!StringSupport.equals(insPlan.CanadianInstitutionCode, oldInsPlan.CanadianInstitutionCode))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CanadianInstitutionCode = '" + POut.string(insPlan.CanadianInstitutionCode) + "'";
        }
         
        if (!StringSupport.equals(insPlan.RxBIN, oldInsPlan.RxBIN))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "RxBIN = '" + POut.string(insPlan.RxBIN) + "'";
        }
         
        if (insPlan.CobRule != oldInsPlan.CobRule)
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "CobRule = " + POut.int(((Enum)insPlan.CobRule).ordinal()) + "";
        }
         
        if (!StringSupport.equals(insPlan.SopCode, oldInsPlan.SopCode))
        {
            if (!StringSupport.equals(command, ""))
            {
                command += ",";
            }
             
            command += "SopCode = '" + POut.string(insPlan.SopCode) + "'";
        }
         
        if (StringSupport.equals(command, ""))
        {
            return ;
        }
         
        command = "UPDATE insplan SET " + command + " WHERE PlanNum = " + POut.long(insPlan.PlanNum);
        Db.nonQ(command);
    }

    /**
    * Deletes one InsPlan from the database.
    */
    public static void delete(long planNum) throws Exception {
        String command = "DELETE FROM insplan " + "WHERE PlanNum = " + POut.long(planNum);
        Db.nonQ(command);
    }

}


